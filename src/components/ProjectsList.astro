---
interface Project {
  name: string;
  url: string;
  description: string;
  number: string;
  secondaryUrl?: string;
  secondaryLabel?: string;
}

interface Props {
  limit?: number;
}

const { limit } = Astro.props;

const projects: Project[] = [
  {
    number: "01",
    name: "Open Seer",
    url: "https://github.com/crisog/openseer",
    description: "Self-hosted, horizontally scalable HTTP monitoring with a modern web interface",
  },
  {
    number: "02",
    name: "pgcollector-ingest",
    url: "https://github.com/crisog/pgcollector-ingest",
    description: "Ingest pganalyze PostgreSQL snapshots and expose them as Prometheus metrics",
  },
  {
    number: "03",
    name: "PostgreSQL + PITR",
    url: "https://railway.com/deploy/postgresql-barman--1?referralCode=9m68fX&utm_medium=integration&utm_source=template&utm_campaign=generic",
    secondaryUrl: "https://github.com/crisog/barman-pg-docker",
    secondaryLabel: "GitHub",
    description: "Railway template that deploys PostgreSQL with Point-In-Time Recovery using Barman",
  },
  {
    number: "04",
    name: "Railway SDK",
    url: "https://github.com/crisog/railway-sdk",
    description: "Lightweight TypeScript SDK for Railway.com",
  },
  {
    number: "05",
    name: "Railway MCP Server",
    url: "https://github.com/crisog/railway-mcp-server",
    description: "Unofficial Model Context Protocol server exposing Railway resources and automation tools to MCP clients",
  },
  {
    number: "06",
    name: "FFmpeg REST API",
    url: "https://railway.com/deploy/ffmpeg-rest-api?referralCode=crisog",
    secondaryUrl: "https://github.com/crisog/ffmpeg-rest",
    secondaryLabel: "GitHub",
    description: "REST API wrapping FFmpeg for media processing with Node.js, Hono, and BullMQ for async job processing",
  },
];

const displayedProjects = limit ? projects.slice(0, limit) : projects;
---

<div class="grid md:grid-cols-3 gap-6 pt-8">
  {
    displayedProjects.map((project) => (
      <div class="border border-white/20 p-6 space-y-3 hover:border-white/60 transition-colors backdrop-blur-sm">
        <div class="text-xs opacity-60 tracking-widest">{project.number}</div>
        <h3 class="text-lg tracking-wide">{project.name}</h3>
        <p class="text-xs opacity-70 leading-relaxed">
          {project.description}
        </p>
        <div class="pt-2 flex gap-3 items-center">
          {project.secondaryUrl ? (
            <>
              <a
                href={project.url}
                target="_blank"
                rel="noopener noreferrer"
                class="hover:opacity-60 transition-opacity"
              >
                <img src="/railway-logo-light.svg" alt="Railway" class="h-4 w-4 opacity-60" />
              </a>
              <a
                href={project.secondaryUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="text-sm hover:opacity-60 transition-opacity"
              >
                <i class="fab fa-github opacity-60" />
              </a>
            </>
          ) : (
            <a
              href={project.url}
              target="_blank"
              rel="noopener noreferrer"
              class="text-sm hover:opacity-60 transition-opacity"
            >
              <i class="fab fa-github opacity-60" />
            </a>
          )}
        </div>
      </div>
    ))
  }
</div>
